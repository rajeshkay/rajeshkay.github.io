<!DOCTYPE html>
<html>
<h1>Common Causes of Stroke </h1>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {fill: lightblue; stroke: black;} </style>
<body onload='init()'>
<div class="svg-cont">
<h2>This is an svg-cntainer</h2>
<h3> </h3>
<svg width=500 height=500>
</svg>
</div>
<button></button>
<script>

async function init() {

var margin = 50;
var height = d3.select("svg").attr("height");
var width = d3.select("svg").attr("width");
var glucTickVals = [50,100, 150, 200, 250]
var ageTickVals = [30, 40, 50, 60, 70, 80]


d3.select("h3")
	.text("Age vs Avg Glucose Level and BMI")

var data1 = await d3.csv("https://flunky.github.io/cars2017.csv");
//console.log(data1[0].Make)
//console.log(data1[0].Fuel)

var data = await d3.csv("https://rajeshkay.github.io/data/stroke-data.csv");
console.log(data[0])

var age = data.map(function(d) {
	return parseInt(d.age); });

var avgGlucoseLevel = data.map(function(d) {
	return parseFloat(d.avg_glucose_level); });

console.log(d3.min(age))
console.log(d3.max(age))
console.log((avgGlucoseLevel))
console.log(d3.min(avgGlucoseLevel))
console.log(d3.max(avgGlucoseLevel))

var scaleX = d3.scaleLinear()
		.domain([50, d3.max(avgGlucoseLevel)])
		.range([0,400])


var scaleY = d3.scaleLinear()
		.domain([20, d3.max(age)])
		.range([400,0])


xAxis = d3.axisBottom(scaleX)
		.tickValues(glucTickVals)
		.tickFormat(function(d, i) {return glucTickVals[i]});

yAxis = d3.axisLeft(scaleY)
		.tickValues(ageTickVals)
		.tickFormat(function(d, i) {return ageTickVals[i]});

var svg = d3.select("svg")
		.append("g")
		.attr("transform", "translate(" +margin+ "," +margin+ ")")

svg.selectAll("circle")
		.data(data)
		.enter()
		.append("circle")
		.attr("cx", function(d,i) {return (scaleX(data[i].avg_glucose_level))})
		.attr("cy", function(d,i) {return (scaleY(data[i].age))})
		.attr("r", function(d,i) {return (parseInt(data[i].bmi)/6)});

d3.select("svg")
	.append("g")
	.attr("transform", "translate("+margin+","+margin+")")
	.call(yAxis);

d3.select("svg")
	.append("g")
	.attr("transform", "translate("+margin+","+(height - margin)+")")
	.call(xAxis);

//d3.select("svg")
//	.append("button")

d3.select("button")
	.text("next")
	.on("click", function() {
		clean();
		displayChart2();
	});

}

async function displayChart2() {

var margin = 50;
d3.select("svg")
  .style("background-color", "lightgray");

var height = d3.select("svg").attr("height");
var width = d3.select("svg").attr("width");

var glucTickVals = [50,100, 150, 200, 250]
var ageTickVals = [30, 40, 50, 60, 70, 80]
var colors = ["red", "green"];

var data = await d3.csv("https://rajeshkay.github.io/data/stroke-data.csv");
console.log("displaychart2");
console.log(data[0])

var age = data.map(function(d) {
	return parseInt(d.age); });

var avgGlucoseLevel = data.map(function(d) {
	return parseFloat(d.avg_glucose_level); });

var scaleX = d3.scaleLinear()
		.domain([50, d3.max(avgGlucoseLevel)])
		.range([0,400])


var scaleY = d3.scaleLinear()
		.domain([20, d3.max(age)])
		.range([400,0])


xAxis = d3.axisBottom(scaleX)
		.tickValues(glucTickVals)
		.tickFormat(function(d, i) {return glucTickVals[i]});

yAxis = d3.axisLeft(scaleY)
		.tickValues(ageTickVals)
		.tickFormat(function(d, i) {return ageTickVals[i]});

var svg = d3.select("svg")
		.append("g")
		.attr("transform", "translate(" +margin+ "," +margin+ ")")

svg.selectAll("circle")
		.data(data)
		.enter()
		.append("circle")
		.attr("cx", function(d,i) {return (scaleX(data[i].avg_glucose_level))})
		.attr("cy", function(d,i) {return (scaleY(data[i].age))})
		.attr("r", function(d,i) {return (parseInt(data[i].bmi)/6)})
		.style('fill',function(d,i) {
			if (data[i].gender == "Female") 
				return "green";
			else
				return "red";
			})
		.style('stroke',function(d,i) {
			if (data[i].gender == "Female") 
				return "green";
			else
				return "red";
			});

d3.select("svg")
	.append("g")
	.attr("transform", "translate("+margin+","+margin+")")
	.call(yAxis);

d3.select("svg")
	.append("g")
	.attr("transform", "translate("+margin+","+(height - margin)+")")
	.call(xAxis);

//d3.select("svg")
//	.append("button")

d3.select("button")
	.text("prev")
	.on("click", function() {
		clean();
		init();
	});

d3.select("h3")
	.text("NEXT: Age vs Avg Glucose Level and BMI")
}

async function clean() {

d3.select("svg").selectAll("*").remove();

var height = 500;
var width = 500;

//d3.select("div")
//  .append("svg")
d3.select("svg")
  .attr("width", width)
  .attr("height", height);

}

</script>
</body>
</html>
