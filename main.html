<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<head>
	<meta charset="UTF-8">
	<title>Common Causes of Stroke</title>
</head>
<body onload='chart1()'>
<header>
    <h1 style="color: brown;"><center>Common Causes of Stroke</center></color></h1>
    <nav>
      <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
</header>

<main>
    <section class="sec1">
	<div class="div1">
	    <h3><center></center></h3>
	    <p></p>
	    <svg class="svg1"><center></center> </svg>
	</div>
        <button class="one" onclick='chart1()'>1</button>
        <button class="two" onclick='chart2()'>2</button>
    </section>

    <section>
      <h2>Contact</h2>
      <form>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <br>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
        <br>
        <input type="submit" value="Submit">
      </form>
    </section>
</main>

<script>

var COL_MALE = "red";
var COL_FEMALE = "green";

var SZE_vSMALL = 1;
var SZE_SMALL = 3;
var SZE_MED = 5;
var SZE_LARGE = 7;
var SZE_vLARGE = 9;

var margin = 50;

// Get the window dimensions
var windowWidth = window.innerWidth;
var windowHeight = window.innerHeight;


function svg_init() {
    var height = 600;
    var width = 600;

var centerX = (windowWidth - width) / 2;
var centerY = (windowHeight - height) / 2;

    d3.select(".svg1")
	.attr("width", width)
	.attr("height", height)
	.style("position", "relative")
	.style("left", centerX + "px")
	.style("top", centerY + "px")
	.style("background-color", "lightgray");

}

function clean(svg=".svg1") {
    d3.select(svg).selectAll("*").remove();
    d3.select(".div1").select("h3").text("");
    d3.select(".div1").select("p").text("");
}

function bmi_size(bmi) {
   if(bmi <= 18.5) 
	return SZE_vSMALL;
   else if (bmi <= 24.9)
	return SZE_SMALL;
   else if (bmi <= 29.9)
	return SZE_MED;
   else
	return SZE_vLARGE;
}

function gender_col(gender) {
   if (gender == "Female")
	return COL_FEMALE;
   else
	return COL_MALE;
}

async function chart1() {
    clean();
    svg_init();

    var margin = 50;

    svg_init();
    svg1 = d3.select(".svg1");

    var height = svg1.attr("height");
    var width = svg1.attr("width");

    var ageTickVals = [30, 40, 50, 60, 70, 80]

    var div1 = d3.select(".div1");

    div1.select("h3")
	.text("Age");

    var data = await d3.csv("https://rajeshkay.github.io/data/stroke-data.csv");

    var age = data.map(function(d) {
	return parseInt(d.age); });

    var id = data.map(function(d) {
	return parseFloat(d.id); });

    var scaleX = d3.scaleLinear()
		.domain([0, d3.max(id)])
		.range([0,height-(2*margin)])

    var scaleY = d3.scaleLinear()
		.domain([20, d3.max(age)])
		.range([width-(2*margin),0])


    xAxis = d3.axisBottom(scaleX)

//		.tickValues(glucTickVals)
//		.tickFormat(function(d, i) {return glucTickVals[i]});

    yAxis = d3.axisLeft(scaleY)
		.tickValues(ageTickVals)
		.tickFormat(function(d, i) {return ageTickVals[i]});

    svg1 = d3.select(".svg1")
                .append("g")
                .attr("transform", "translate(" +margin+ "," +margin+ ")")
    
    svg1.selectAll("circle")
		.data(data)
		.enter()
		.append("circle")
		.attr("cx", function(d,i) { return (scaleX(data[i].id)) })
		.attr("cy", function(d,i) { return (scaleY(data[i].age)) })
		.attr("r", function(d,i)  { return SZE_MED })
		.style("fill", function(d,i)  { return gender_col(data[i].gender) })
		.style("stroke", function(d,i)  { return gender_col(data[i].gender) })


    d3.select(".svg1")
	.append("g")
	.attr("transform", "translate("+margin+","+margin+")")
	.call(yAxis);

    d3.select(".svg1")
	.append("g")
	.attr("transform", "translate("+margin+","+(height - margin)+")")
	.call(xAxis);
}

async function chart2() {
    clean();
    svg_init();

    var margin = 50;

    svg_init();
    svg1 = d3.select(".svg1");

    var height = svg1.attr("height");
    var width = svg1.attr("width");

    var glucTickVals = [50,100, 150, 200, 250]
    var ageTickVals = [30, 40, 50, 60, 70, 80]

    var div1 = d3.select(".div1");

    div1.select("h3")
	.text("Age vs Avg Glucose Level");

    div1.select("p")
	.text("Size of the Mark indicates BMI");

    var data = await d3.csv("https://rajeshkay.github.io/data/stroke-data.csv");

    var age = data.map(function(d) {
	return parseInt(d.age); });

    var avgGlucoseLevel = data.map(function(d) {
	return parseFloat(d.avg_glucose_level); });

    var scaleX = d3.scaleLinear()
		.domain([50, d3.max(avgGlucoseLevel)])
		.range([0,height-(2*margin)])

    var scaleY = d3.scaleLinear()
		.domain([20, d3.max(age)])
		.range([width-(2*margin),0])


    xAxis = d3.axisBottom(scaleX)
		.tickValues(glucTickVals)
		.tickFormat(function(d, i) {return glucTickVals[i]});

    yAxis = d3.axisLeft(scaleY)
		.tickValues(ageTickVals)
		.tickFormat(function(d, i) {return ageTickVals[i]});

    svg1 = d3.select(".svg1")
                .append("g")
                .attr("transform", "translate(" +margin+ "," +margin+ ")")
    
    svg1.selectAll("circle")
		.data(data)
		.enter()
		.append("circle")
		.attr("cx", function(d,i) { return (scaleX(data[i].avg_glucose_level)) })
		.attr("cy", function(d,i) { return (scaleY(data[i].age)) })
		.attr("r", function(d,i)  { return bmi_size(data[i].bmi) })
		.style("fill", function(d,i)  { return gender_col(data[i].gender) })
		.style("stroke", function(d,i)  { return gender_col(data[i].gender) })


    d3.select(".svg1")
	.append("g")
	.attr("transform", "translate("+margin+","+margin+")")
	.call(yAxis);

    d3.select(".svg1")
	.append("g")
	.attr("transform", "translate("+margin+","+(height - margin)+")")
	.call(xAxis);
}

</script>
<footer>
    <p>&copy; 2023 My Webpage. All rights reserved.</p>
</footer>
</body>
</html>
